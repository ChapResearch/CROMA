<?php
/**
 * @file
 * This is the main module file.
 */

include_once("notification.inc");
include_once("notifDisplay.php");
include_once("/var/www-croma/croma_modules/blockSupport.php");

// $casesBlockInfo - an array of info that is passed to Drupal
//      when it asks about the module.
//
// $casesBlockViewFns - an array of functions that are called
//      when Drupal calls *_block_view();
//

global $notifBlockInfo;
global $notifBlockViewFns;

$notifBlockInfo = array();
$notifBlockViewFns = array();

//
// define the INFO and HANDLERS for the different blocks defined in this file
//
$notifBlockInfo['notifications_view'] = array( "info" => t("Notifications View"), "cache" => DRUPAL_CACHE_GLOBAL );
$notifBlockViewFns['notifications_view'] =
    function(&$block) {
        $block['subject'] = t('View Notifications');
	$block['content'] = viewNotifications("1");
    };

/*
  Implements hook_help().
*/
function notification_help($path, $arg) {

  if ($path == 'admin/help#rupalform') {
    $output = '<h3>' . t('About') . '</h3>';
    $output .= '<p>' . t('The notification module manages notifications in CROMA.') . '</p>';
    return $output;
  }
}

//
// provide information about the blocks that this module provides
//
function notification_block_info()
{
    global $notifBlockInfo;

    return($notifBlockInfo);
}

//
// hook in the blocks
//
function notification_block_view($delta = '')
{
    global $notifBlockViewFns;

    $block = array();

    if(array_key_exists($delta,$notifBlockViewFns)) {
        $notifBlockViewFns[$delta]($block);
    }
    print_r($block);
    return $block;
}

?>